# Code to prepare internal data sets
# Written by Kevin Potter
# email: kpotter5@mgh.harvard.edu
# Please email me directly if you
# have any questions or comments
# Last updated 2025-04-11

# Table of contents
# 1) swaap_internal.linking_items_marginal_rates
#   1.1) Include missing values
#     1.1.1) Kindergarten year
#     1.1.2) Sex at birth
#     1.1.3) Year and month of birth
#     1.1.4) Middle initial
#     1.1.5) Eye color
#     1.1.6) Older siblings
#     1.1.7) Street name
#   1.2) Exclude missing values
#     1.2.1) Kindergarten year
#     1.2.2) Sex at birth
#     1.2.3) Year and month of birth
#     1.2.4) Middle initial
#     1.2.5) Eye color
#     1.2.6) Older siblings
#     1.2.7) Street name
# ?) Development code

#### 1) swaap_internal.linking_items_marginal_rates ####

swaap_internal.linking_items_marginal_rates <- list(
  #### 1.1) Include missing values ####
  include_NA = list(
    #### 1.1.1) Kindergarten year ####
    SBJ.INT.Link.KindergartenYearEst = data.frame(
      Values = c(
        2013,
        2014
      ),
      Freq = c(
        4182,
        1421
      )
    ),
    #### 1.1.2) Sex at birth ####
    SBJ.FCT.Sex = data.frame(
      Values = c(
        "Female",
        "Male",
        NA
      ),
      Freq = c(
        2959,
        2703,
        115
      )
    ),
    #### 1.1.3) Year and month of birth ####
    SBJ.DTM.Dob = data.frame(
      Values = c(
        "2006-01-01",
        "2006-02-01",
        "2006-03-01",
        "2006-04-01",
        "2006-05-01",
        "2006-06-01",
        "2006-07-01",
        "2006-08-01",
        "2006-09-01",
        "2006-10-01",
        "2006-11-01",
        "2006-12-01",
        "2007-01-01",
        "2007-02-01",
        "2007-03-01",
        "2007-04-01",
        "2007-05-01",
        "2007-06-01",
        "2007-07-01",
        "2007-08-01",
        "2007-09-01",
        "2007-10-01",
        "2007-11-01",
        "2007-12-01",
        "2008-01-01",
        "2008-02-01",
        "2008-03-01",
        "2008-04-01",
        "2008-05-01",
        "2008-06-01",
        "2008-07-01",
        "2008-08-01",
        "2008-09-01",
        "2008-10-01",
        "2008-11-01",
        "2008-12-01",
        "2009-01-01",
        "2009-02-01",
        "2009-03-01",
        "2009-04-01",
        "2009-05-01",
        "2009-06-01",
        "2009-07-01",
        "2009-08-01",
        "2009-09-01",
        "2009-10-01",
        "2009-11-01",
        "2009-12-01",
        NA
      ),
      Freq = c(
        3,
        5,
        10,
        4,
        12,
        5,
        8,
        8,
        24,
        9,
        14,
        23,
        24,
        36,
        39,
        24,
        52,
        54,
        65,
        133,
        295,
        288,
        296,
        304,
        288,
        290,
        296,
        333,
        336,
        348,
        307,
        258,
        144,
        111,
        111,
        117,
        127,
        101,
        97,
        100,
        136,
        102,
        94,
        86,
        12,
        15,
        8,
        7,
        218
      )
    ),
    #### 1.1.4) Middle initial ####
    SBJ.FCT.Link.MiddleInitial = data.frame(
      Values = c(
        "a",
        "b",
        "c",
        "d",
        "e",
        "f",
        "g",
        "h",
        "i",
        "j",
        "k",
        "l",
        "m",
        "n",
        "no middle name",
        "o",
        "p",
        "q",
        "r",
        "s",
        "t",
        "u",
        "v",
        "w",
        "x",
        "y",
        "z",
        NA
      ),
      Freq = c(
        515,
        125,
        233,
        198,
        322,
        116,
        183,
        80,
        98,
        479,
        156,
        298,
        587,
        145,
        647,
        49,
        153,
        10,
        338,
        254,
        156,
        9,
        68,
        86,
        14,
        58,
        19,
        381
      )
    ),
    #### 1.1.5) Eye color ####
    SBJ.FCT.Link.EyeColor = data.frame(
      Values = c(
        "Black",
        "Blue",
        "Brown",
        "Gray",
        "Green",
        "Hazel",
        NA
      ),
      Freq = c(
        488,
        987,
        2792,
        103,
        420,
        660,
        327
      )
    ),
    #### 1.1.6) Older siblings ####
    SBJ.FCT.Link.OlderSiblings = data.frame(
      Values = c(
        "1 older sibling born in April",
        "1 older sibling born in August",
        "1 older sibling born in December",
        "1 older sibling born in February",
        "1 older sibling born in January",
        "1 older sibling born in July",
        "1 older sibling born in June",
        "1 older sibling born in March",
        "1 older sibling born in May",
        "1 older sibling born in November",
        "1 older sibling born in October",
        "1 older sibling born in September",
        "2 older siblings, the oldest born in April",
        "2 older siblings, the oldest born in August",
        "2 older siblings, the oldest born in December",
        "2 older siblings, the oldest born in February",
        "2 older siblings, the oldest born in January",
        "2 older siblings, the oldest born in July",
        "2 older siblings, the oldest born in June",
        "2 older siblings, the oldest born in March",
        "2 older siblings, the oldest born in May",
        "2 older siblings, the oldest born in November",
        "2 older siblings, the oldest born in October",
        "2 older siblings, the oldest born in September",
        "3 or more older siblings, the oldest born in April",
        "3 or more older siblings, the oldest born in August",
        "3 or more older siblings, the oldest born in December",
        "3 or more older siblings, the oldest born in February",
        "3 or more older siblings, the oldest born in January",
        "3 or more older siblings, the oldest born in July",
        "3 or more older siblings, the oldest born in June",
        "3 or more older siblings, the oldest born in March",
        "3 or more older siblings, the oldest born in May",
        "3 or more older siblings, the oldest born in November",
        "3 or more older siblings, the oldest born in October",
        "3 or more older siblings, the oldest born in September",
        "no older siblings",
        "NA"
      ),
      Freq = c(
        133,
        177,
        156,
        127,
        140,
        148,
        109,
        130,
        148,
        141,
        162,
        153,
        68,
        59,
        71,
        65,
        72,
        63,
        71,
        70,
        73,
        67,
        83,
        76,
        55,
        50,
        46,
        48,
        56,
        56,
        47,
        51,
        63,
        58,
        64,
        69,
        2100,
        452
      )
    ),
    #### 1.1.7) Street name ####
    SBJ.CHR.Link.Streetname = data.frame(
      Values = c(
        "a",
        "abc",
        "ald",
        "ant",
        "app",
        "aqu",
        "ash",
        "aub",
        "aus",
        "bar",
        "bay",
        "bea",
        "bee",
        "ben",
        "bos",
        "boy",
        "bra",
        "bro",
        "cab",
        "ced",
        "cha",
        "cir",
        "cla",
        "con",
        "coo",
        "cot",
        "cre",
        "crx",
        "cyn",
        "dee",
        "del",
        "dru",
        "dud",
        "dun",
        "eas",
        "edw",
        "eis",
        "elm",
        "ess",
        "exc",
        "fai",
        "fen",
        "fey",
        "fos",
        "fou",
        "fra",
        "gay",
        "geo",
        "ger",
        "gle",
        "gre",
        "gro",
        "ham",
        "han",
        "haw",
        "her",
        "hig",
        "hil",
        "hud",
        "hun",
        "hyd",
        "idk",
        "ind",
        "iro",
        "jea",
        "jer",
        "jod",
        "jun",
        "kar",
        "ken",
        "kin",
        "kno",
        "laf",
        "lan",
        "las",
        "lex",
        "lit",
        "lon",
        "luc",
        "ma",
        "mar",
        "mas",
        "mav",
        "may",
        "mil",
        "min",
        "mor",
        "mtp",
        "mur",
        "new",
        "nor",
        "nos",
        "oak",
        "obe",
        "oca",
        "old",
        "orc",
        "orq",
        "oxf",
        "par",
        "phe",
        "pla",
        "ple",
        "pur",
        "qua",
        "red",
        "ric",
        "riv",
        "roc",
        "rol",
        "roo",
        "row",
        "rua",
        "sad",
        "sag",
        "sam",
        "sau",
        "sch",
        "sec",
        "sev",
        "sha",
        "she",
        "sou",
        "spr",
        "sto",
        "str",
        "sum",
        "syc",
        "tal",
        "tay",
        "tho",
        "tim",
        "tow",
        "tra",
        "tur",
        "uni",
        "val",
        "wal",
        "war",
        "was",
        "wes",
        "whe",
        "whi",
        "wil",
        "win",
        "woo",
        "wor",
        NA
      ),
      Prob = c(
        0.002,
        4e-04,
        0.0024,
        0.0012,
        0.0032,
        0.0016,
        0.00841,
        0.002,
        4e-04,
        0.01081,
        0.0052,
        0.01681,
        0.0056,
        0.002,
        0.00921,
        0.0048,
        0.00961,
        0.02522,
        0.0016,
        0.00681,
        0.01481,
        0.0024,
        0.00961,
        0.01121,
        0.0028,
        0.0048,
        0.006,
        8e-04,
        4e-04,
        0.0012,
        0.002,
        8e-04,
        0.0016,
        0.002,
        0.01801,
        4e-04,
        0.0016,
        0.01361,
        0.00801,
        0.002,
        0.00961,
        0.0024,
        4e-04,
        0.002,
        0.00841,
        0.01001,
        0.002,
        0.0044,
        0.002,
        0.00801,
        0.01481,
        0.00841,
        0.006,
        0.0056,
        0.002,
        0.0028,
        0.01601,
        0.01041,
        0.0028,
        0.0036,
        8e-04,
        0.03643,
        0.0032,
        8e-04,
        4e-04,
        0.0016,
        8e-04,
        0.0044,
        0.0012,
        0.01161,
        0.00641,
        0.0036,
        0.004,
        0.00641,
        0.0012,
        0.002,
        0.0012,
        0.0036,
        0.0012,
        0.0016,
        0.01281,
        0.00841,
        0.002,
        0.0032,
        0.00841,
        0.0016,
        0.006,
        8e-04,
        0.0024,
        0.01001,
        0.02242,
        0.0016,
        0.01401,
        4e-04,
        0.0012,
        0.01561,
        0.004,
        4e-04,
        0.0012,
        0.02322,
        0.004,
        0.0056,
        0.01361,
        0.0012,
        0.0032,
        0.0024,
        0.00681,
        0.006,
        0.006,
        0.0052,
        0.0028,
        0.0016,
        0.0032,
        0.0012,
        0.0016,
        0.0024,
        0.0012,
        0.00761,
        0.0044,
        0.002,
        0.0048,
        0.00841,
        0.02482,
        0.01001,
        0.01001,
        0.02322,
        0.01561,
        0.0016,
        0.0016,
        0.0012,
        0.0048,
        0.0024,
        0.006,
        0.002,
        0.006,
        0.00801,
        0.0032,
        0.01922,
        0.00801,
        0.02042,
        0.03122,
        0.002,
        0.01081,
        0.01321,
        0.01681,
        0.01201,
        0.0036,
        0.06966
      )
    )
  ),
  #### 1.2) Exclude missing values ####
  exclude_NA = list(
    #### 1.2.1) Kindergarten year ####
    SBJ.INT.Link.KindergartenYearEst = data.frame(
      Values = c(
        2013,
        2014
      ),
      Prob = c(
        0.7467,
        0.2533
      )
    ),
    #### 1.2.2) Sex at birth ####
    SBJ.FCT.Sex = data.frame(
      Values = c(
        "Female",
        "Male"
      ),
      Prob = c(
        0.52303,
        0.47697
      )
    ),
    #### 1.2.3) Year and month of birth ####
    SBJ.DTM.Dob = data.frame(
      Values = c(
        "2006-01-01",
        "2006-02-01",
        "2006-03-01",
        "2006-04-01",
        "2006-05-01",
        "2006-06-01",
        "2006-07-01",
        "2006-08-01",
        "2006-09-01",
        "2006-10-01",
        "2006-11-01",
        "2006-12-01",
        "2007-01-01",
        "2007-02-01",
        "2007-03-01",
        "2007-04-01",
        "2007-05-01",
        "2007-06-01",
        "2007-07-01",
        "2007-08-01",
        "2007-09-01",
        "2007-10-01",
        "2007-11-01",
        "2007-12-01",
        "2008-01-01",
        "2008-02-01",
        "2008-03-01",
        "2008-04-01",
        "2008-05-01",
        "2008-06-01",
        "2008-07-01",
        "2008-08-01",
        "2008-09-01",
        "2008-10-01",
        "2008-11-01",
        "2008-12-01",
        "2009-01-01",
        "2009-02-01",
        "2009-03-01",
        "2009-04-01",
        "2009-05-01",
        "2009-06-01",
        "2009-07-01",
        "2009-08-01",
        "2009-09-01",
        "2009-10-01",
        "2009-11-01",
        "2009-12-01"
      ),
      Prob = c(
        0.00054,
        9e-04,
        0.0018,
        0.00072,
        0.00216,
        9e-04,
        0.00144,
        0.00144,
        0.00432,
        0.00162,
        0.00252,
        0.00414,
        0.00414,
        0.00648,
        0.00702,
        0.00432,
        0.00936,
        0.00972,
        0.01152,
        0.02394,
        0.05311,
        0.05185,
        0.05329,
        0.05473,
        0.05185,
        0.05203,
        0.05329,
        0.05995,
        0.06049,
        0.06265,
        0.05527,
        0.04644,
        0.02592,
        0.01998,
        0.01998,
        0.02088,
        0.02286,
        0.01818,
        0.01746,
        0.018,
        0.02448,
        0.01836,
        0.01692,
        0.01548,
        0.00216,
        0.0027,
        0.00144,
        0.00125
      )
    ),
    #### 1.2.4) Middle initial ####
    SBJ.FCT.Link.MiddleInitial = data.frame(
      Values = c(
        "a",
        "b",
        "c",
        "d",
        "e",
        "f",
        "g",
        "h",
        "i",
        "j",
        "k",
        "l",
        "m",
        "n",
        "no middle name",
        "o",
        "p",
        "q",
        "r",
        "s",
        "t",
        "u",
        "v",
        "w",
        "x",
        "y",
        "z"
      ),
      Prob = c(
        0.09504,
        0.0231,
        0.04301,
        0.03663,
        0.05992,
        0.02104,
        0.034,
        0.01465,
        0.01841,
        0.08903,
        0.02911,
        0.05522,
        0.108,
        0.02724,
        0.11983,
        0.00883,
        0.02855,
        0.00188,
        0.06292,
        0.04715,
        0.02911,
        0.00169,
        0.01277,
        0.01615,
        0.00263,
        0.01071,
        0.00338
      )
    ),
    #### 1.2.5) Eye color ####
    SBJ.FCT.Link.EyeColor = data.frame(
      Values = c(
        "Black",
        "Blue",
        "Brown",
        "Gray",
        "Green",
        "Hazel"
      ),
      Prob = c(
        0.08971,
        0.1809,
        0.51163,
        0.01898,
        0.07742,
        0.12135
      )
    ),
    #### 1.2.6) Older siblings ####
    SBJ.FCT.Link.OlderSiblings = data.frame(
      Values = c(
        "1 older sibling born in April",
        "1 older sibling born in August",
        "1 older sibling born in December",
        "1 older sibling born in February",
        "1 older sibling born in January",
        "1 older sibling born in July",
        "1 older sibling born in June",
        "1 older sibling born in March",
        "1 older sibling born in May",
        "1 older sibling born in November",
        "1 older sibling born in October",
        "1 older sibling born in September",
        "2 older siblings, the oldest born in April",
        "2 older siblings, the oldest born in August",
        "2 older siblings, the oldest born in December",
        "2 older siblings, the oldest born in February",
        "2 older siblings, the oldest born in January",
        "2 older siblings, the oldest born in July",
        "2 older siblings, the oldest born in June",
        "2 older siblings, the oldest born in March",
        "2 older siblings, the oldest born in May",
        "2 older siblings, the oldest born in November",
        "2 older siblings, the oldest born in October",
        "2 older siblings, the oldest born in September",
        "3 or more older siblings, the oldest born in April",
        "3 or more older siblings, the oldest born in August",
        "3 or more older siblings, the oldest born in December",
        "3 or more older siblings, the oldest born in February",
        "3 or more older siblings, the oldest born in January",
        "3 or more older siblings, the oldest born in July",
        "3 or more older siblings, the oldest born in June",
        "3 or more older siblings, the oldest born in March",
        "3 or more older siblings, the oldest born in May",
        "3 or more older siblings, the oldest born in November",
        "3 or more older siblings, the oldest born in October",
        "3 or more older siblings, the oldest born in September",
        "no older siblings"
      ),
      Prob = c(
        0.02514,
        0.03314,
        0.02952,
        0.024,
        0.02628,
        0.02742,
        0.02,
        0.02476,
        0.0278,
        0.02666,
        0.03085,
        0.02895,
        0.01295,
        0.01086,
        0.01333,
        0.01219,
        0.01371,
        0.01181,
        0.01314,
        0.01314,
        0.01371,
        0.01276,
        0.01504,
        0.01428,
        0.01028,
        0.00933,
        0.00857,
        0.00895,
        0.01066,
        0.01047,
        0.00895,
        0.00971,
        0.01181,
        0.01086,
        0.01219,
        0.01276,
        0.39402
      )
    ),
    #### 1.2.7) Street name ####
    SBJ.CHR.Link.Streetname = data.frame(
      Values = c( "a", "abb", "abc", "abd", "ace", "ack", "aco", "acr", "ad", "ada",
                  "add", "ade", "adm", "aga", "age", "ala", "alb", "ald", "ale", "alf",
                  "ali", "all", "alm", "alo", "als", "alt", "alv", "ame", "amh", "ams",
                  "and", "ang", "ann", "ant", "anz", "ape", "app", "aps", "apt", "aqu",
                  "arb", "arc", "ark", "arl", "arn", "arr", "ars", "art", "arv", "asc",
                  "asf", "ash", "aso", "asp", "ass", "ast", "ath", "atk", "atl", "atw",
                  "aub", "aud", "aul", "aur", "aus", "aut", "ava", "ave", "avf", "avn",
                  "axe", "axl", "aza", "b", "bab", "bac", "bak", "bal", "ban", "bar",
                  "bas", "bat", "bau", "bay", "baz", "bbc", "bcn", "bea", "beb", "bec",
                  "bed", "bee", "bel", "bem", "ben", "beo", "ber", "bes", "bet", "bev",
                  "bey", "bha", "bic", "bid", "big", "bil", "bin", "bir", "bis", "bit",
                  "bjl", "bla", "blo", "blu", "bnc", "boa", "bob", "bog", "bol", "bon",
                  "bor", "bos", "bou", "bov", "bow", "box", "boy", "br", "bra", "bre",
                  "bri", "bro", "bru", "bry", "brz", "bub", "buc", "buf", "bul", "bum",
                  "bur", "but", "bzl", "c", "cab", "cac", "cal", "cam", "can", "cap",
                  "car", "cas", "cat", "cau", "cax", "ccc", "cdr", "cds", "cea", "ced",
                  "cen", "cer", "ces", "cha", "che", "chi", "chr", "chu", "cid", "cir",
                  "cla", "cle", "cli", "clo", "cls", "cly", "coa", "cob", "cod", "coe",
                  "col", "com", "con", "coo", "cop", "cor", "cot", "cou", "cov", "coy",
                  "cr", "cra", "cre", "cri", "cro", "crx", "cs", "csa", "ct", "cum",
                  "cun", "cur", "cus", "cut", "cyn", "cyp", "d", "dae", "dai", "dal",
                  "dam", "dan", "dar", "dav", "daw", "day", "dea", "dec", "ded", "dee",
                  "del", "dem", "den", "dep", "der", "des", "det", "dev", "dew", "dex",
                  "dfg", "dia", "dic", "dik", "dil", "din", "div", "dnt", "do", "doa",
                  "dob", "dod", "doe", "don", "dop", "dor", "dou", "dov", "dow", "dra",
                  "dri", "dru", "drv", "dud", "duk", "dum", "dun", "dup", "dur", "dwi",
                  "e", "eam", "ean", "ear", "eas", "eat", "ebe", "ecu", "edd", "edg",
                  "edi", "edl", "edm", "eds", "edw", "eee", "egc", "egm", "egr", "eig",
                  "eis", "el", "ela", "elb", "eld", "ele", "eli", "ell", "elm", "eme",
                  "emi", "end", "epi", "eri", "ern", "ery", "esp", "ess", "est", "eth",
                  "eto", "euc", "eve", "exc", "fai", "fal", "fam", "far", "faw", "fax",
                  "fay", "fdc", "fea", "fed", "fel", "fen", "fer", "fes", "fey", "fgl",
                  "fid", "fie", "fif", "fin", "fir", "fis", "fit", "fiv", "fla", "fle",
                  "flg", "fli", "flo", "fol", "for", "fos", "fou", "fow", "fox", "fra",
                  "fre", "fro", "fry", "fuc", "ful", "fur", "g", "gab", "gag", "gal",
                  "gan", "gar", "gat", "gav", "gay", "gen", "geo", "ger", "gfy", "gib",
                  "gil", "gin", "gle", "gma", "goh", "gol", "goo", "gor", "gov", "gr",
                  "gra", "gre", "gri", "gro", "grr", "gua", "gue", "gui", "gul", "guy",
                  "gvh", "h", "ha", "hac", "had", "hag", "hai", "hal", "ham", "han",
                  "hap", "har", "has", "hav", "haw", "hay", "haz", "hbr", "hea", "hec",
                  "hed", "hel", "hem", "hen", "her", "hey", "hff", "hia", "hic", "hie",
                  "hig", "hil", "hin", "hit", "hog", "hol", "hom", "hoo", "hop", "hor",
                  "hos", "hou", "hov", "how", "hoy", "hri", "htc", "hud", "hun", "hur",
                  "hut", "hya", "hyd", "i", "id", "ida", "idf", "idk", "idm", "ihk",
                  "ind", "ing", "int", "ire", "iro", "irv", "isa", "isl", "ive", "jac",
                  "jam", "jan", "jao", "jas", "jav", "jay", "jea", "jef", "jen", "jer",
                  "jet", "jew", "jfk", "jho", "jin", "jk", "joa", "jod", "joe", "joh",
                  "jon", "jor", "jos", "jrd", "jud", "jui", "jul", "jun", "kaf", "kah",
                  "kam", "kan", "kar", "kat", "kee", "kei", "kel", "ken", "ket", "kev",
                  "key", "kha", "khu", "ki", "kil", "kim", "kin", "kit", "kli", "kml",
                  "kni", "kno", "kos", "kot", "kra", "kys", "l", "lac", "laf", "lag",
                  "lak", "lam", "lan", "lap", "lar", "las", "lat", "lau", "law", "le",
                  "lea", "leb", "led", "lee", "leg", "lei", "lel", "lem", "leo", "ler",
                  "les", "lev", "lew", "lex", "ley", "lib", "lig", "lil", "lim", "lin",
                  "lit", "liv", "ljk", "lkm", "llp", "llu", "lnn", "loc", "lod", "loe",
                  "log", "lok", "lol", "lon", "lor", "los", "lot", "lou", "lov", "low",
                  "lub", "luc", "lun", "lup", "lws", "lyd", "lym", "lyn", "lyo", "m",
                  "ma", "mac", "mad", "mag", "mai", "mal", "man", "map", "mar", "mas",
                  "mat", "mau", "mav", "max", "may", "mca", "mcc", "mce", "mck", "mcl",
                  "mea", "mec", "med", "meg", "meh", "mei", "mel", "mem", "men", "mer",
                  "mes", "met", "mez", "mhb", "mi", "mic", "mid", "mil", "min", "mlk",
                  "mmg", "mmm", "moc", "mod", "moh", "mol", "mon", "moo", "mor", "mou",
                  "mt", "mth", "mtp", "mu", "mud", "mul", "mun", "mur", "myo", "myr",
                  "mys", "n", "na", "nab", "nad", "nah", "nan", "nap", "nas", "nat",
                  "nau", "nea", "nel", "nep", "net", "new", "nic", "nig", "nin", "nis",
                  "no", "nob", "nol", "non", "nop", "nor", "nos", "not", "nov", "noy",
                  "nra", "nur", "o", "oak", "obe", "obr", "oca", "oce", "och", "oco",
                  "ocs", "odo", "ohi", "old", "olg", "oli", "olm", "olv", "oma", "ome",
                  "one", "ont", "ool", "ora", "orc", "ord", "orl", "orq", "ost", "oti",
                  "out", "ove", "oxb", "oxf", "p", "pac", "pae", "pag", "pai", "pal",
                  "pam", "par", "pas", "pat", "pau", "pay", "pea", "ped", "peg", "pel",
                  "pem", "pen", "pep", "peq", "per", "pet", "pha", "phe", "phi", "pic",
                  "pie", "pig", "pil", "pin", "pip", "pit", "pla", "ple", "pli", "plu",
                  "ply", "pns", "pol", "pon", "poo", "pop", "por", "pos", "pot", "pow",
                  "pra", "pre", "pri", "pro", "prw", "ps", "pta", "ptr", "pue", "puf",
                  "pui", "pur", "pus", "put", "qua", "que", "qui", "r", "ra", "rac",
                  "raf", "rai", "ran", "rav", "raw", "ray", "rd", "rdc", "re", "rec",
                  "red", "ree", "reg", "ren", "res", "rey", "rho", "ric", "rid", "rig",
                  "ril", "rin", "rip", "ris", "rit", "riv", "roa", "rob", "roc", "rod",
                  "rog", "rol", "roo", "ros", "rou", "row", "rox", "roy", "rpd", "rrt",
                  "rua", "rub", "rue", "rug", "rur", "rus", "rut", "rya", "s", "sac",
                  "sad", "sag", "sai", "sal", "sam", "san", "sao", "sar", "sat", "sau",
                  "sav", "saw", "sax", "say", "sce", "sch", "sco", "scr", "scu", "sea",
                  "sec", "sed", "sei", "sem", "sen", "seq", "set", "sev", "sew", "sex",
                  "sey", "sha", "she", "shi", "sho", "shp", "shr", "shu", "sil", "sim",
                  "sin", "six", "ska", "sku", "sla", "smi", "smr", "sms", "sna", "sno",
                  "so", "soa", "som", "sou", "sp", "spa", "spe", "spi", "spo", "spp",
                  "spr", "squ", "srr", "ss", "st", "sta", "ste", "stf", "stg", "sth",
                  "sti", "stm", "sto", "stp", "str", "stu", "suc", "sud", "suf", "sug",
                  "sui", "sum", "sun", "sup", "sur", "sus", "sut", "suv", "svp", "svr",
                  "swa", "syc", "syd", "syl", "sym", "t", "tab", "taf", "tal", "tam",
                  "tap", "tar", "tat", "tau", "tay", "ted", "tee", "tem", "ten", "ter",
                  "tff", "tfs", "tgd", "tgg", "tha", "the", "thi", "tho", "thr", "thy",
                  "tic", "til", "tim", "tis", "tob", "tok", "tom", "ton", "top", "tor",
                  "tot", "tou", "tow", "tra", "trd", "tre", "tri", "tro", "tru", "tsm",
                  "tuc", "tui", "tul", "tur", "twe", "twg", "two", "tyl", "tyn", "tyu",
                  "u", "una", "uni", "unt", "uph", "upl", "upp", "ush", "uth", "v",
                  "vae", "val", "van", "var", "vea", "veg", "ven", "ver", "vic", "vil",
                  "vin", "vir", "vis", "vog", "vos", "vtr", "vue", "w", "wac", "wad",
                  "wag", "wal", "war", "was", "wat", "wav", "way", "wea", "web", "wel",
                  "wen", "wes", "wet", "wha", "whe", "whi", "wic", "wil", "win", "wis",
                  "wit", "wls", "wol", "woo", "wor", "wos", "wre", "wrs", "wt", "wyc",
                  "wye", "wym", "xav", "xim", "y", "yew", "yoe", "yor", "yow", "ytf",
                  "yub", "yup", "zab", "zhu", "zir", "zon" ),
      Prob = c( 5, 3, 2, 1, 1, 1, 5, 3, 1, 7,
                1, 1, 3, 1, 1, 2, 3, 7, 2, 1,
                1, 6, 1, 2, 1, 2, 1, 5, 3, 1,
                5, 3, 1, 3, 1, 1, 8, 1, 2, 4,
                3, 4, 2, 16, 4, 1, 4, 4, 1, 2,
                1, 21, 1, 8, 1, 1, 2, 1, 4, 4,
                5, 2, 1, 1, 1, 1, 2, 11, 1, 2,
                1, 1, 2, 1, 3, 5, 4, 11, 3, 27,
                2, 6, 1, 13, 1, 1, 1, 42, 1, 3,
                2, 14, 17, 3, 5, 1, 8, 1, 7, 7,
                1, 1, 1, 1, 1, 1, 1, 5, 5, 1,
                1, 9, 4, 3, 1, 2, 2, 5, 1, 10,
                1, 25, 2, 1, 7, 1, 12, 1, 25, 9,
                28, 64, 4, 4, 1, 2, 6, 2, 7, 2,
                10, 5, 1, 1, 4, 1, 2, 6, 13, 1,
                21, 5, 1, 1, 1, 1, 1, 1, 2, 17,
                28, 2, 1, 39, 45, 5, 2, 9, 2, 6,
                24, 5, 18, 3, 1, 1, 3, 2, 1, 1,
                17, 16, 28, 7, 2, 8, 12, 8, 3, 2,
                1, 12, 15, 1, 14, 2, 1, 1, 2, 1,
                1, 16, 1, 1, 1, 4, 4, 1, 1, 2,
                2, 14, 5, 25, 3, 3, 7, 1, 1, 3,
                5, 3, 3, 3, 3, 1, 1, 8, 1, 5,
                1, 1, 1, 1, 1, 1, 1, 1, 1, 2,
                1, 1, 4, 6, 1, 4, 2, 4, 4, 7,
                2, 2, 1, 4, 1, 2, 5, 1, 1, 5,
                1, 2, 1, 1, 45, 2, 1, 1, 1, 11,
                2, 1, 2, 1, 1, 1, 1, 6, 1, 4,
                4, 1, 1, 1, 1, 1, 7, 11, 34, 3,
                3, 5, 1, 4, 1, 1, 3, 20, 6, 1,
                1, 1, 7, 5, 24, 7, 1, 20, 3, 1,
                3, 1, 1, 1, 5, 6, 11, 1, 1, 1,
                2, 2, 1, 1, 5, 2, 5, 1, 9, 2,
                1, 4, 5, 3, 18, 6, 22, 1, 5, 27,
                15, 3, 1, 2, 7, 1, 1, 1, 1, 3,
                1, 13, 3, 1, 5, 6, 11, 5, 1, 2,
                3, 1, 20, 1, 1, 2, 5, 7, 3, 1,
                32, 38, 5, 21, 1, 2, 1, 3, 4, 1,
                1, 1, 1, 1, 9, 1, 1, 3, 16, 14,
                2, 41, 5, 5, 5, 2, 1, 1, 8, 1,
                1, 1, 3, 6, 7, 1, 1, 1, 5, 1,
                42, 26, 1, 1, 1, 24, 7, 4, 6, 1,
                4, 4, 1, 11, 1, 1, 1, 7, 9, 2,
                3, 2, 2, 4, 2, 1, 1, 92, 1, 1,
                8, 4, 6, 1, 2, 2, 1, 3, 1, 12,
                6, 5, 1, 1, 1, 2, 1, 8, 2, 4,
                1, 4, 1, 1, 1, 1, 2, 2, 1, 15,
                2, 3, 3, 1, 3, 1, 1, 11, 1, 1,
                2, 2, 3, 2, 2, 1, 7, 29, 2, 2,
                3, 1, 1, 1, 5, 2, 16, 2, 1, 1,
                3, 9, 2, 2, 1, 2, 3, 1, 10, 2,
                15, 5, 17, 3, 7, 3, 3, 6, 16, 1,
                4, 1, 5, 1, 2, 1, 1, 1, 4, 1,
                3, 1, 7, 5, 1, 11, 5, 1, 1, 27,
                3, 2, 1, 1, 1, 1, 1, 4, 2, 1,
                2, 4, 1, 9, 7, 2, 1, 2, 4, 10,
                1, 3, 3, 1, 1, 1, 4, 3, 1, 4,
                4, 3, 5, 7, 49, 15, 10, 27, 32, 21,
                2, 3, 5, 2, 8, 1, 1, 1, 1, 1,
                12, 3, 2, 1, 1, 1, 6, 2, 5, 9,
                2, 3, 1, 1, 2, 7, 6, 21, 4, 1,
                1, 1, 1, 1, 6, 1, 10, 3, 16, 6,
                1, 1, 2, 1, 1, 1, 1, 6, 1, 3,
                3, 3, 3, 1, 2, 4, 4, 3, 2, 1,
                1, 1, 4, 6, 1, 27, 3, 1, 5, 1,
                10, 3, 1, 2, 1, 56, 7, 5, 2, 1,
                1, 1, 2, 35, 1, 1, 3, 5, 1, 1,
                1, 1, 2, 40, 1, 1, 1, 1, 1, 3,
                4, 1, 1, 3, 12, 3, 1, 1, 2, 2,
                2, 4, 1, 3, 1, 1, 2, 3, 3, 3,
                1, 58, 2, 3, 3, 6, 12, 1, 1, 1,
                1, 5, 1, 3, 4, 5, 1, 10, 7, 2,
                5, 1, 4, 22, 1, 2, 15, 38, 1, 1,
                6, 1, 3, 9, 1, 2, 5, 1, 3, 4,
                2, 8, 14, 15, 1, 1, 1, 1, 1, 1,
                1, 3, 1, 4, 8, 1, 4, 3, 1, 3,
                1, 5, 10, 1, 3, 7, 1, 1, 1, 1,
                6, 3, 2, 3, 6, 1, 1, 18, 8, 1,
                1, 5, 2, 3, 1, 16, 3, 15, 15, 2,
                1, 14, 7, 6, 2, 4, 1, 4, 1, 1,
                8, 1, 2, 1, 1, 13, 2, 1, 5, 4,
                3, 4, 6, 11, 6, 25, 4, 10, 1, 3,
                2, 4, 2, 1, 1, 19, 5, 1, 1, 8,
                11, 2, 1, 1, 1, 1, 1, 5, 4, 1,
                1, 12, 21, 4, 2, 1, 3, 1, 1, 2,
                1, 8, 1, 1, 2, 7, 1, 1, 2, 4,
                2, 1, 2, 63, 1, 5, 1, 1, 1, 1,
                27, 1, 1, 1, 5, 18, 23, 3, 1, 1,
                2, 1, 25, 1, 67, 2, 1, 3, 2, 1,
                1, 41, 14, 1, 5, 2, 3, 2, 1, 2,
                4, 4, 1, 2, 1, 2, 2, 1, 4, 3,
                5, 7, 2, 2, 3, 4, 1, 6, 1, 4,
                1, 1, 1, 1, 8, 3, 8, 12, 3, 1,
                2, 1, 6, 3, 1, 6, 1, 1, 2, 2,
                1, 1, 15, 5, 1, 7, 1, 5, 1, 1,
                3, 1, 1, 15, 3, 1, 5, 3, 2, 1,
                1, 1, 20, 1, 1, 1, 1, 1, 1, 2,
                1, 8, 2, 2, 1, 1, 1, 8, 4, 14,
                1, 5, 2, 1, 1, 1, 1, 2, 2, 1,
                3, 51, 21, 52, 8, 4, 1, 2, 5, 6,
                2, 79, 1, 2, 5, 27, 2, 33, 42, 1,
                2, 1, 9, 31, 10, 2, 1, 1, 1, 2,
                1, 6, 1, 1, 1, 2, 1, 7, 1, 1,
                1, 1, 2, 1, 1, 1
                )
    )
  )
)

#### 2) swaap_internal.linking_item_discrepancies ####

swaap_internal.linking_item_discrepancies <- list(
  marginal_rates = data.frame(
    Item = c(
      'SBJ.INT.Link.SchoolCode',
      'SBJ.INT.Link.SchoolID',
      'SBJ.INT.Link.KindergartenYearEst',
      'SBJ.CHR.Link.Sex',
      'SBJ.CHR.Link.DateOfBirth',
      'SBJ.CHR.Link.MiddleInitial',
      'SBJ.CHR.Link.EyeColor',
      'SBJ.CHR.Link.OlderSiblings',
      'SBJ.CHR.Link.Streetname'
    ),
    N = c(
      337,
      121,
      336,
      334,
      329,
      326,
      335,
      322,
      326
    ),
    Matched = c(
      336,
      108,
      325,
      329,
      318,
      295,
      275,
      265,
      259
    )
  )
)

#### ?) Development code ####

# Function to help create responses
if ( FALSE ) {

  fun_create_data_frame <- function(vec_values, na.rm = TRUE ) {

    if ( na.rm ) {
      vec_values <- vec_values[ !is.na(vec_values) ]
    }

    int_freq <- table(vec_values, useNA = 'ifany' )

    chr_values <-
      paste0( '    "', names(int_freq),
              c( rep( '",\n', length(int_freq) - 1 ), '"\n' ) ) |>
      paste( collapse = '' )
    chr_freq <-
      paste0( '    ', int_freq,
              c( rep( ',\n', length(int_freq) - 1 ), '\n' ) ) |>
      paste( collapse = '' )
    chr_values <- gsub(
      '"NA"', 'NA', chr_values, fixed = TRUE
    )

    chr_code <- paste0(
      'dtf_possible <- data.frame(\n',
      '  Values = c(\n',
      chr_values,
      "  ),\n",
      "  Freq = c(\n",
      chr_freq,
      '  )\n',
      ')\n'
    )

    lst_nuisance <- sapply( chr_code, message )
  }

  chr_wd <- getwd()
  chr_path <- paste0(
    "E:/CAM/CAM_R_projects/CAM_analyses/Dropbox/",
    "SWA-2015/SWA-BIAA-2023/BIAA-A001-Primary"
  )
  setwd( chr_path )

  targets::tar_load( dtf_SRV.Full )

  setwd( chr_wd )



  dtf_SRV.Full <- dtf_SRV.Full |>
    dplyr::filter(
      !SBJ.CHR.Link.DateOfBirth %in% c(
          '15-06-01',
          '16-08-01',
          '19-10-01',
          '1987-09-01',
          '200-12-01',
          '4-11-01',
          '8-01-01'
        ) &
        ( SBJ.INT.AgeInYears %in% c(
          14, 15, 16, 17
        ) | is.na( SBJ.INT.AgeInYears ) )
    )


  dtf_age <- data.frame(
    Grade = 6:12,
    Min = 10:16,
    Max = 13:19
  )

  r = 1


  dtf_SRV.Current <- dtf_SRV.Full |>
    dplyr::filter(
      SSS.INT.Grade %in% dtf_age$Grade[r] &
      ( SBJ.INT.AgeInYears %in% (dtf_age$Min[r]:dtf_age$Max[r]) |
        is.na( SBJ.INT.AgeInYears ) )
    )

  dtf_SRV.SBIRT_23F$SBJ.CHR.Link.Sex |> table()

  usethis::use_data(
    swaap_internal.linking_items_marginal_rates,
    overwrite = TRUE,
    internal = TRUE
  )

  # Close 'Function to help create responses'
}


